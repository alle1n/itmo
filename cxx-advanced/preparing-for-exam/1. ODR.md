### Что это

C++ требует, чтобы любая функция (и т.д.) была определена не более одного раза. Как только вы определяете функцию с одним и тем же именем и сигнатурой в разных единицах трансляции (файлах `.cpp`), вы получаете ошибку на этапе линковки.

`inline` функции обычно определяются в заголовочных файлах (`.h`), чтобы все единицы трансляции могли видеть реализацию функции и подставить ее по месту вызова. Соответственно, как только вы включите заголовочный файл с такой функцией в более чем одну единицу трансляции, ODR будет формально нарушено, но… никакой индикации ошибки вы не получите.

Почему и какие неожиданные последствия это может иметь?

С одной стороны, запретить описанную выше ситуацию нельзя из практических соображений – нужно, чтобы реализация функции была доступна из всех вызывающих ее единиц трансляции, иначе подстановка может оказаться невозможной. С другой стороны, ODR нарушается и хорошо бы на это отреагировать.

Реагировать можно двумя способами – сообщением об ошибке или молчанием. В этом конкретном случае линкер выбирает второе. Как только линкер видит более одной `inline` функции с одним и тем же именем и одной и той же сигнатурой, он считает, что это одна и та же функция, и выбирает **одну из них на свое усмотрение**.

Так формальное нарушение ODR формально устраняется.

### Правила ODR

1. В пределах любой единицы трансляции шаблон, тип данных, функция или объект не могут иметь более одного определения, хотя могут иметь неограниченное число объявлений.
2. В пределах программы (совокупности всех единиц трансляции) внешний объект или внешняя не-inline функция не могут иметь больше одного определения; если объект или функция используются, у каждого из них должно быть строго по единственному определению. Можно объявить объект или функцию, которые не будут использованы в программе, в этом случае не потребуется и их определения. Ни в коем случае не должно быть более одного определения.
3. Типы, шаблоны и inline-функции (то есть те сущности, у которых определение полностью или частично совмещается с объявлением) могут определяться в более чем одной единице трансляции, но для каждой такой сущности все её определения должны быть идентичны.
4. Определения объектов и функций, не являющихся внешними (`extern`), в разных единицах трансляции определяют различные сущности, даже если их имена и типы совпадают. Эти определения беспрепятственно могут различаться.